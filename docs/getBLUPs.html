<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Get BLUPs | Cassava GS SOPs</title>
  <meta name="description" content="Documentation for genomic selection-related standard operating procedures used for NextGen Cassava Breeding." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Get BLUPs | Cassava GS SOPs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Documentation for genomic selection-related standard operating procedures used for NextGen Cassava Breeding." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Get BLUPs | Cassava GS SOPs" />
  
  <meta name="twitter:description" content="Documentation for genomic selection-related standard operating procedures used for NextGen Cassava Breeding." />
  

<meta name="author" content="Marnin Wolfe" />


<meta name="date" content="2020-02-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="curateTrials.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cassava GS SOPs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#workflows-use-cases"><i class="fa fa-check"></i><b>0.1</b> Workflows / Use Cases</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#example_data"><i class="fa fa-check"></i><b>0.2</b> Example data</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#appendices"><i class="fa fa-check"></i><b>0.3</b> Appendices</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="prepTP.html"><a href="prepTP.html"><i class="fa fa-check"></i><b>1</b> Prepare training data</a><ul>
<li class="chapter" data-level="1.1" data-path="prepTP.html"><a href="prepTP.html#cassavabase-download"><i class="fa fa-check"></i><b>1.1</b> Cassavabase download</a></li>
<li class="chapter" data-level="1.2" data-path="prepTP.html"><a href="prepTP.html#formatting-and-initial-qc"><i class="fa fa-check"></i><b>1.2</b> Formatting and initial QC</a><ul>
<li class="chapter" data-level="1.2.1" data-path="prepTP.html"><a href="prepTP.html#checklist"><i class="fa fa-check"></i><b>1.2.1</b> Checklist</a></li>
<li class="chapter" data-level="1.2.2" data-path="prepTP.html"><a href="prepTP.html#specifications-for-output"><i class="fa fa-check"></i><b>1.2.2</b> Specifications for Output</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="prepTP.html"><a href="prepTP.html#worked-example"><i class="fa fa-check"></i><b>1.3</b> Worked example</a><ul>
<li class="chapter" data-level="1.3.1" data-path="prepTP.html"><a href="prepTP.html#read-in-data"><i class="fa fa-check"></i><b>1.3.1</b> Read-in data</a></li>
<li class="chapter" data-level="1.3.2" data-path="prepTP.html"><a href="prepTP.html#traits-and-traitabbreviations"><i class="fa fa-check"></i><b>1.3.2</b> Traits and TraitAbbreviations</a></li>
<li class="chapter" data-level="1.3.3" data-path="prepTP.html"><a href="prepTP.html#qc-trait-values"><i class="fa fa-check"></i><b>1.3.3</b> QC Trait values</a></li>
<li class="chapter" data-level="1.3.4" data-path="prepTP.html"><a href="prepTP.html#harvest-index"><i class="fa fa-check"></i><b>1.3.4</b> Harvest Index</a></li>
<li class="chapter" data-level="1.3.5" data-path="prepTP.html"><a href="prepTP.html#unit-area-traits"><i class="fa fa-check"></i><b>1.3.5</b> Unit area traits</a></li>
<li class="chapter" data-level="1.3.6" data-path="prepTP.html"><a href="prepTP.html#season-wide-mean-cmds"><i class="fa fa-check"></i><b>1.3.6</b> Season-wide mean CMDS</a></li>
<li class="chapter" data-level="1.3.7" data-path="prepTP.html"><a href="prepTP.html#assign-genos-to-phenos"><i class="fa fa-check"></i><b>1.3.7</b> Assign genos to phenos</a></li>
<li class="chapter" data-level="1.3.8" data-path="prepTP.html"><a href="prepTP.html#write-cleaned-dataset"><i class="fa fa-check"></i><b>1.3.8</b> Write cleaned dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="curateTrials.html"><a href="curateTrials.html"><i class="fa fa-check"></i><b>2</b> Curate by trial</a><ul>
<li class="chapter" data-level="2.1" data-path="curateTrials.html"><a href="curateTrials.html#worked-example-1"><i class="fa fa-check"></i><b>2.1</b> Worked example</a><ul>
<li class="chapter" data-level="2.1.1" data-path="curateTrials.html"><a href="curateTrials.html#format-input-data"><i class="fa fa-check"></i><b>2.1.1</b> Format input data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="curateTrials.html"><a href="curateTrials.html#under-construction"><i class="fa fa-check"></i><b>2.2</b> UNDER CONSTRUCTION</a><ul>
<li class="chapter" data-level="2.2.1" data-path="curateTrials.html"><a href="curateTrials.html#function-to-analyze-trials"><i class="fa fa-check"></i><b>2.2.1</b> Function to analyze trials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getBLUPs.html"><a href="getBLUPs.html"><i class="fa fa-check"></i><b>3</b> Get BLUPs</a><ul>
<li class="chapter" data-level="3.1" data-path="getBLUPs.html"><a href="getBLUPs.html#explanation-of-two-stage-prediction"><i class="fa fa-check"></i><b>3.1</b> Explanation of two-stage prediction</a></li>
<li class="chapter" data-level="3.2" data-path="getBLUPs.html"><a href="getBLUPs.html#set-up-training-data-chunks"><i class="fa fa-check"></i><b>3.2</b> Set-up training data chunks</a></li>
<li class="chapter" data-level="3.3" data-path="getBLUPs.html"><a href="getBLUPs.html#fit-lmer-models"><i class="fa fa-check"></i><b>3.3</b> Fit lmer models</a></li>
<li class="chapter" data-level="3.4" data-path="getBLUPs.html"><a href="getBLUPs.html#extract-and-de-regress-blups"><i class="fa fa-check"></i><b>3.4</b> Extract and de-regress BLUPs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cassava GS SOPs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="getBLUPs" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Get BLUPs</h1>
<div id="explanation-of-two-stage-prediction" class="section level2">
<h2><span class="header-section-number">3.1</span> Explanation of two-stage prediction</h2>
<p>For now best to see, <strong>EiB GS workshop from Sept. 2018</strong> <a href="https://drive.google.com/open?id=1ND7vCAEoKuv5wtQe_nPZhFSx3JJOe3tr">here</a>, especially the <strong>GSprocess_SupportingMaterial.html</strong>.</p>
<p><strong>Two-stage</strong> genomic prediction refers to the following procedure:</p>
<p><strong>Stage 1:</strong> Fit a linear mixed model to the data <em>without</em> genomic data. Individuals (e.g. clones / accessions) are modeled as independent and identically distributed (<em>i.i.d.</em>) random effects. The BLUPs for this random effect represent the measurable total genetic values of each individual. All the experimental design variation, e.g. replication and blocking effects have been controlled for in the creation of our new response variable, the BLUPs from the gneotype random effect.</p>
<p><strong>Stage 2:</strong> Using a modified version of the BLUPs from step 1 as the response variable, fit a genomic prediction model, which now has reduced size because the number of observations is now the same as the number of individuals.</p>
<p><strong>NOTE:</strong> In the animal breeding literature <strong>single-step</strong> often refers to predictions that combine pedigree and marker information simultaneously. That <em>is not</em> our meaning here.</p>
</div>
<div id="set-up-training-data-chunks" class="section level2">
<h2><span class="header-section-number">3.2</span> Set-up training data chunks</h2>
<p>Using the curated trial data (BLUPs?) from the <a href="curateTrials.html#curateTrials">previous step</a> as input.</p>
</div>
<div id="fit-lmer-models" class="section level2">
<h2><span class="header-section-number">3.3</span> Fit lmer models</h2>
</div>
<div id="extract-and-de-regress-blups" class="section level2">
<h2><span class="header-section-number">3.4</span> Extract and de-regress BLUPs</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="curateTrials.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CassavaGS_SOPs.pdf", "CassavaGS_SOPs.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
